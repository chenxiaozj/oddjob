<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<oddjob>
    <job>
        <sequential>
            <jobs>
                <sql name="Create table">
                    <connection>
                        <connection driver="org.hsqldb.jdbcDriver" id="connection" url="jdbc:hsqldb:mem:test" username="sa"/>
                    </connection>
                    <input>
        	            <buffer>
	        	            <![CDATA[create table NUMBERS(NUMBER varchar(20))]]>
    	                </buffer>
                    </input>
                </sql>
                <repeat name="Repeat Ten Times">
                    <job>
                        <sequential name="Repeat Sequence">
                            <jobs>
                                <sequence id="seqnum" watch="${reset.current}"/>
                                <variables id="vars">
                                    <seqnumFormatted>
                                        <format format="0000" number="${seqnum.current}"/>
                                    </seqnumFormatted>
                                </variables>
                                <sql name="Insert Row">
                                    <connection>
                                        <value value="${connection}"/>
                                    </connection>
                                    <input>
	                                    <buffer>
    	                                	<![CDATA[insert into numbers (number) values ('${vars.seqnumFormatted}')]]>
        	                            </buffer>
                                    </input>
                                </sql>
                            </jobs>
                        </sequential>
                    </job>
                    <schedule>
                        <s:count count="10" xmlns:s="http://rgordon.co.uk/oddjob/schedules"/>
                    </schedule>
                </repeat>
                <sql name="Get Count">
                    <connection>
                        <value value="${connection}"/>
                    </connection>
                    <results>
                    	<sql-results-bean id="result"/>
                    </results>
                    <input>
                    	<buffer>
<![CDATA[select count(*) "count" from numbers]]>
                 	   </buffer>
                 	</input>
                 </sql>
                <sql name="Shutdown">
                    <connection>
                        <value value="${connection}"/>
                    </connection>
                    <input>
	                    <buffer>
	                    	<![CDATA[Shutdown]]>
	                    </buffer>
                    </input>
               </sql>
            </jobs>
        </sequential>
    </job>
</oddjob>
